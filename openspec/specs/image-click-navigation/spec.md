# image-click-navigation Specification

## Purpose
画像そのものをクリックでページ送りできる機能を提供します。単一画像・見開き表示の両方に対応し、右開き書籍の読み方向に合わせた左右の方向判定を行います。

## Requirements
### Requirement: 単一画像クリックによる次ページ移動
単一画像が表示されているとき、その画像をクリックすると次ページに移動しなければならない（SHALL）。移動先の画像がまだ読み込まれていない場合も正しく動作する。

#### Scenario: 単一画像をクリックして次ページに移動
- **WHEN** ユーザーが単一画像を表示している画面で画像をクリックする
- **THEN** 次のページの画像がビューポートの中央に表示される

#### Scenario: 単一画像クリック時に移動先が最終ページ超過の場合
- **WHEN** ユーザーが最終ページの単一画像をクリックする
- **THEN** メタデータモーダル（info 画面）が自動で表示される

### Requirement: 見開き表示時の左右クリックによるページ移動
見開き表示（2画像並び、右開き）のとき、左側画像クリックで次ページ、右側画像クリックで前ページに移動しなければならない（SHALL）。

#### Scenario: 見開き表示で左側画像をクリック
- **WHEN** ユーザーが見開き表示の左側画像をクリックする
- **THEN** 次のページの画像がビューポートの中央に表示される

#### Scenario: 見開き表示で右側画像をクリック
- **WHEN** ユーザーが見開き表示の右側画像をクリックする
- **THEN** 前のページの画像がビューポートの中央に表示される

#### Scenario: 見開き表示で右側画像クリックが最初ページの場合
- **WHEN** ユーザーが最初ページの見開き表示で右側画像をクリックする
- **THEN** ページ移動は行われず、現在の表示のままで残る

### Requirement: 見開き表示で画像が1枚だけの場合のクリック動作
見開きモードが有効だが画像が1枚しか表示されていない場合、クリックで次ページに移動しなければならない（SHALL）。

#### Scenario: 見開き1枚のときクリック
- **WHEN** 見開きモードが有効で画像が1枚しか表示されていない状態にある
- **AND** ユーザーがその画像をクリックする
- **THEN** 次のページの画像がビューポートの中央に表示される

### Requirement: クリック判定とドラッグの分離
クリック判定はmousedown位置とmouseup位置の移動距離で判別し、閾値（5px）以上の移動がある場合はクリックとして扱わなければならないものとする（SHALL）。

#### Scenario: 移動なしのクリック
- **WHEN** ユーザーが画像上でmousedownしてほぼ同じ位置でmouseupする（移動距離 < 5px）
- **THEN** クリック判定として対応するページ移動が実行される

#### Scenario: 移動あり（ドラッグっぽい動作）
- **WHEN** ユーザーが画像上でmousedownして5px以上移動した後にmouseupする
- **THEN** クリック判定としては扱わず、ページ移動は実行されない

### Requirement: モーダル表示中やスクリプト無効時のクリック無視
モーダルが表示されている場合やスクリプトが無効の場合、画像クリックによるページ移動は実行されなければならないものとはならない（SHALL NOT）。

#### Scenario: モーダル表示中のクリック
- **WHEN** メタデータモーダルまたはヘルプモーダルが表示されている
- **AND** ユーザーが画像をクリックする
- **THEN** ページ移動は実行されない

#### Scenario: スクリプト無効時のクリック
- **WHEN** スクリプトが無効（enabled = false）の状態にある
- **AND** ユーザーが画像をクリックする
- **THEN** ページ移動は実行されない
