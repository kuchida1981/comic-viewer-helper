# Site Adapter (サイトアダプター)

## Purpose
システムが特定のサイト構造（DOM、セレクタ、要素取得ロジック等）に依存しないように抽象化し、マルチサイト対応を容易にします。
## Requirements
### Requirement: サイトアダプターインターフェースの定義
システムは、特定のサイト構造に依存しないよう、サイトごとの差異（セレクタ、要素取得ロジック等）を吸収するための共通インターフェース（サイトアダプター）を定義しなければならない（SHALL）。

**アダプターが提供する機能:**
- URLに対する適合判定
- サイト固有のセレクタ/取得ロジック
- **メタデータ抽出時のタグ種別判定**

#### Scenario: サイト適合判定
- **WHEN** ページが読み込まれた時
- **THEN** 各アダプターが現在のURLに適合するかを判定し、適切なアダプターが選択されること

#### Scenario: サイト固有セレクタの提供
- **WHEN** アプリケーションが画像コンテナや画像要素を特定する必要がある時
- **THEN** 選択されたアダプターから提供されるサイト固有のセレクタが使用されること

#### Scenario: サイト固有の画像取得ロジック
- **WHEN** 標準的なセレクタのみでは画像取得が困難なサイトにおいて画像を取得する時
- **THEN** アダプターが提供する独自の取得ロジック（関数等）が実行されること

#### Scenario: タグ種別の判定
- **WHEN** アダプターがメタデータを抽出する時
- **THEN** 各タグの href を解析し、パスに基づいてタグ種別（type）を判定して返す
- **AND** タグオブジェクトには `type: string | null` プロパティが含まれる

### Requirement: 非公開作品へのフラグ付与
アダプターは、メタデータ抽出時の `relatedWorks` に対し、タイトルの先頭が「非公開」であるかを判定し、該当する作品に `isPrivate: true` を付与しなければならない (SHALL)。

#### Scenario: 非公開作品のフラグ付与
- **WHEN** アダプターが関連作品リストを抽出し、ある作品のタイトルが「非公開」で始まる
- **THEN** その作品オブジェクトに `isPrivate: true` が付与される

#### Scenario: 公開作品のフラグ付与
- **WHEN** アダプターが関連作品リストを抽出し、あるタイトルが「非公開」で始まらない
- **THEN** その作品オブジェクトに `isPrivate: false` が付与される

