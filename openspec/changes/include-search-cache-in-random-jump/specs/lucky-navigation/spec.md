## MODIFIED Requirements

### Requirement: 関連作品へのランダム遷移
システムは、現在表示されている作品の関連作品リストおよび検索結果のキャッシュから、対象となる作品を抽出し、その中からランダムに1つを選択して遷移する機能を提供しなければならない (SHALL)。
対象作品の抽出ルールは以下の通りとする：
- `metadata.relatedWorks` からは `isPrivate` でない作品を抽出する。
- 検索キャッシュ (`SearchCache`) が存在する場合、TTL (1時間) の経過に関わらず、その結果 (`results`) を全て抽出対象とする。
- 抽出された作品リストは、URL (`href`) に基づいて重複を排除する（バイアスを避けるため）。

#### Scenario: 関連作品が存在し検索キャッシュがない場合の遷移
- **WHEN** ユーザーが「おすすめ（ランダム）」ボタンをクリックする
- **AND** 検索キャッシュが存在しない
- **THEN** システムは `metadata.relatedWorks` リストから `isPrivate` でない作品のみを対象とし、ランダムに1つ選択して遷移する

#### Scenario: 関連作品と検索キャッシュが存在する場合の遷移
- **WHEN** ユーザーが「おすすめ（ランダム）」ボタンをクリックする
- **AND** 検索キャッシュが存在する（TTL経過後も含む）
- **THEN** システムは `metadata.relatedWorks` (非公開除く) と検索キャッシュの結果をマージし、URLで重複排除したリストからランダムに1つ選択して遷移する

### Requirement: キーボード・ショートカットによるランダム遷移
システムは、キーボード・ショートカットによっても「おすすめ（ランダム）」機能を発火できなければならない (SHALL)。発火後の遷移ロジック（関連作品と検索キャッシュからの抽出・重複排除・ランダム選択）は既存のボタン発火と同一でなければならない。

#### Scenario: キーボード・ショートカットによる遷移
- **WHEN** ユーザーが指定された右手側キーを押下する
- **AND** 関連作品または検索キャッシュに対象作品が存在する
- **THEN** システムは更新されたランダム選択ロジック（関連作品+検索キャッシュ）で1つの作品を選び、遷移する
