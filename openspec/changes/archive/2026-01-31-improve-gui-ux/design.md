## Context

現在の GUI は絶対座標で位置を保持しており、ウィンドウサイズが大幅に縮小された（全画面解除など）際に、GUI がビューポート外に取り残される問題があります。また、GUI が常に不透明で表示されているため、画像コンテンツの一部を隠してしまい、読書の没入感を妨げることがあります。

## Goals / Non-Goals

**Goals:**
- ウィンドウサイズ変更時に GUI を常に可視範囲内（ビューポート内）に維持する。
- マウスホバーの状態に応じて GUI の不透明度を動的に変更し、没入感を向上させる。
- ユーザーが手動で移動させた際も、画面外への逸脱を防止する。

**Non-Goals:**
- GUI の完全な非表示化（常に最小限の視認性は維持する）。
- 複雑なアニメーションの導入（シンプルかつスムーズな不透明度遷移に留める）。

## Decisions

### 1. 境界チェックロジックの共通化 (`src/ui/Draggable.js`)
- **決定**: ドラッグ移動中およびウィンドウリサイズ時の両方で利用できる共通の「引き戻し（Clamp）」関数を `Draggable.js` に実装する。
- **理由**: 重複コードを避け、常に同一の境界ルール（例：画面端から 10px のパディング）を適用するため。

### 2. リサイズイベントの集約 (`src/main.js`)
- **決定**: `window.onresize` イベントハンドラ内で、`Draggable` インスタンスの境界チェックメソッドを呼び出す。
- **理由**: ウィンドウサイズが変更された瞬間に即座に GUI を安全な位置へ移動させるため。

### 3. CSS Transition による不透明度制御
- **決定**: `src/ui/styles.js` に `.comic-helper-gui` などのベースクラスと、ホバー時のスタイルを定義し、`opacity` と `transition: opacity 0.3s` を使用する。
- **理由**: JS で毎フレーム不透明度を計算するよりもパフォーマンスが良く、滑らかな視覚効果が得られるため。

## Risks / Trade-offs

- **[Risk] パーセンテージ座標への移行に伴う計算誤差** → ピクセルベースで管理しつつ、リサイズ時に「右端からの距離」を維持するか検討が必要。
  - **Mitigation**: 今回はシンプルに「画面外に出た場合のみ引き戻す」ロジックから開始し、必要に応じて相対座標化を検討する。
- **[Risk] 透明すぎて GUI を見失う** → `opacity: 0.3` 程度を下限とし、完全に消えないようにする。
  - **Mitigation**: 常に一定の視認性を確保する最小不透明度を設定する。
